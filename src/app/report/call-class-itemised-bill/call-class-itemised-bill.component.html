<h3 *ngIf="reportheader">Call Category - {{reportheader}}</h3>

<input type="button" class="btn btn-primary" (click)="goback()" value="Back" />


<div class="row col-lg-12 vert-offset-top-1 lbl-bold">

    <div class="form-inline">
        <div class="form-group display-flex">

            <label *ngIf="mobilenumber && callclassreportviewmodel?.username;else other_content">Itemised Bill for -
                {{  callclassreportviewmodel?.username}} - {{mobilenumber}} </label>

            <ng-template #other_content>

                <label *ngIf="mobilenumber">Itemised Bill for - {{mobilenumber}} </label>
            </ng-template>
        </div>
    </div>
</div>
<div class="row col-lg-12 vert-offset-top-1 lbl-bold">
    <!-- <div class="row col-lg-12 vert-offset-top-1">

        <div class="form-inline">
            <div class="form-group display-flex" [ngClass]="{ 'has-danger':error}">
                <div *ngIf="!reportheader" class="row col-lg-6">
                    <label> From Month</label>
                    <p-dropdown [options]="invoicemonthArray" [(ngModel)]="fromdate" name="frominvoicemonth"
                        (onChange)="onInvoiceMonthChange()" filter="filter">
                    </p-dropdown>
                </div>
                <div *ngIf="!reportheader" class="row col-lg-6">
                    <label> To Month</label>
                    <p-dropdown [options]="invoicemonthArray" [(ngModel)]="todate" name="toinvoicemonth"
                        (onChange)="onInvoiceMonthChange()" filter="filter">
                    </p-dropdown>

                </div>
            </div>
        </div>

        <div *ngIf="error" class="error">{{error}}</div>

    </div> -->

    <div class="form-inline" *ngIf="frommonth">

        <div *ngIf="!reportheader" class="form-group">
            <label class="col-lg-6" style="padding: 0px; display: block;"> From Month</label>
            <p-dropdown [options]="invoicemonthArray" [(ngModel)]="fromdate" name="frominvoicemonth"
                class="form-copntrol" (onChange)="onInvoiceMonthChange()" filter="filter">
            </p-dropdown>
        </div>
        <div *ngIf="!reportheader" class="form-group" >
            <label class="col-lg-6" style="padding: 0px; display: block;"> To Month</label>
            <p-dropdown [options]="invoicemonthArray" [(ngModel)]="todate" name="toinvoicemonth" class="form-copntrol"
                (onChange)="onInvoiceMonthChange()" filter="filter">
            </p-dropdown>

        </div>
    </div>
</div>

<div class="row col-lg-12 vert-offset-top-1 lbl-bold">
    <div class=" col-lg-12 text-left">
        <h4>Filters:</h4>
    </div>
    <!--<div class="col-lg-4" *ngIf="month && reportheader">
            <label class="col-lg-4 col-sm-4">Month</label>
            <label class="col-lg-6 col-sm-4">{{month}}</label>
        </div>-->



    <div class="col-lg-4" *ngIf="frommonth">

        <label class="col-lg-4 col-sm-4">From Month</label>


        <label class="col-lg-6 col-sm-4">{{frommonth}}</label>
    </div>
    <div class="col-lg-4" *ngIf="tomonth">
        <label class="col-lg-4 col-sm-4">To Month</label>
        <label class="col-lg-6 col-sm-4">{{tomonth}}</label>
    </div>
    <div class="col-lg-4" *ngIf="ndesc">
        <label class="col-lg-4 col-sm-4">Network</label>
        <label class="col-lg-6 col-sm-4">{{ndesc}}</label>
    </div>
    <div class="col-lg-4" *ngIf="isbenexist && bendesc">
        <label class="col-lg-4 col-sm-4">BEN</label>
        <label class="col-lg-6 col-sm-4">{{bendesc}}</label>
    </div>
    <div class="col-lg-4" *ngIf="isbandisplay && bandesc">
        <label class="col-lg-4 col-sm-4">BAN</label>
        <label class="col-lg-6 col-sm-4">{{bandesc}}</label>
    </div>
    <div class="col-lg-4" *ngIf="isbillingplatformexist && billdesc">
        <label class="col-lg-4 col-sm-4">Billing Platform</label>
        <label class="col-lg-6 col-sm-4">{{billdesc}}</label>
    </div>

    <div class="col-lg-4" *ngIf="reportinggroup1guid">
        <label class="col-lg-4 col-sm-4">{{reportinggroup1description}}</label>
        <label class="col-lg-6 col-sm-4">{{rg1description}}</label>
    </div>
    <div class="col-lg-4" *ngIf="reportinggroup2guid">
        <label class="col-lg-4 col-sm-4">{{reportinggroup2description}}</label>
        <label class="col-lg-6 col-sm-4">{{rg2description}}</label>
    </div>
    <div class="col-lg-4" *ngIf="reportinggroup3guid">
        <label class="col-lg-4 col-sm-4">{{reportinggroup3description}}</label>
        <label class="col-lg-6 col-sm-4">{{rg3description}}</label>
    </div>
    <div class="col-lg-4" *ngIf="reportinggroup4guid">
        <label class="col-lg-4 col-sm-4">{{reportinggroup4description}}</label>
        <label class="col-lg-6 col-sm-4">{{rg4description}}</label>
    </div>
    <div class="col-lg-4" *ngIf="reportinggroup5guid">
        <label class="col-lg-4 col-sm-4">{{reportinggroup5description}}</label>
        <label class="col-lg-6 col-sm-4">{{rg5description}}</label>
    </div>
    <div class="col-lg-4" *ngIf="reportinggroup6guid">
        <label class="col-lg-4 col-sm-4">{{reportinggroup6description}}</label>
        <label class="col-lg-6 col-sm-4">{{rg6description}}</label>
    </div>

</div>






<div class="row col-lg-12 vert-offset-top-1 lbl-bold">

    <div class="row col-lg-12 vert-offset-top-1" *ngIf="callclassitemisedviewmodel?.eurozonedetails?.length">
        <div class=" col-lg-12 text-left">
            <h4>Summary By Euro Zone:</h4>
        </div>
        <ng-template ngFor let-zones [ngForOf]="callclassitemisedviewmodel.eurozonedetails">
            <div class="col-lg-3">
                <label class="col-lg-4 col-sm-4">{{zones.eurozone}}</label>
                <label class="col-lg-7 col-sm-4">{{(zones.usage||0) | currencyFormat}}</label>
            </div>
        </ng-template>


    </div>


    <div class="row col-lg-12 vert-offset-top-1 lbl-bold" *ngIf="callclassreportviewmodel as cc"
        [hidden]="reportheader && !mobilenumber">
        <div class=" col-lg-12 text-left">
            <h4>Usage Summary:</h4>
        </div>
        <div class="col-lg-6 col-sm-12">
            <label class="col-lg-5 col-sm-4">Data</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.gprscost || 0) | currencyFormat}} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.gprsdata || 0)| number }} MB</label>

            <label class="col-lg-5 col-sm-4">Roamed Data</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamedgprscost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamedgprsdata || 0) | number:'1.2-2' }} MB</label>

            <label class="col-lg-5 col-sm-4">Roamed Outgoing</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamedcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamedduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">International</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.intlukcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.intlukduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">International SMS</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.smsoutforeignlegcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.smsoutforeignlegvolumne || 0) }} Texts</label>

            <label class="col-lg-5 col-sm-4">Roamed SMS</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamedincomingsmscost|| 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamedincomingsmsvolume || 0)}} Texts</label>

            <label class="col-lg-5 col-sm-4">National</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.nationalcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.nationalduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">Same Network</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.samenetworkcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.samenetworkduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4"> Cross Net</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.othernetworkcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.othernetworkduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">Non-Geographic</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.nongeographiccost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.nongeographicduration || 0) | number:'1.2-2' }} Mins</label>


        </div>
        <div class="col-lg-6 col-sm-12 float-right">

            <label class="col-lg-5 col-sm-4">Directory Enquiry</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.directoryenquiriescost || 0)| currencyFormat}} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.directoryenquiriesduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">SMS</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.smsoutcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.smsoutvolume || 0)  }} Texts</label>

            <label class="col-lg-5 col-sm-4">Premium SMS</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.premiumsmscost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.premiumsmsvolume || 0) }} Texts</label>

            <label class="col-lg-5 col-sm-4"> Voice Mail </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.voicemailcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.voicemailduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">Premium Service</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.premiumcallcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.premiumcallduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">Roamed Received</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamingreceivedcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.roamingreceivedduraiton || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">Personal Number</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.personalnumbercost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.personalnumberduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">MMS</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.mmsoutcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.mmsoutvolume || 0) }} Texts</label>
            <div *ngIf="ismpayexist">
                <label class="col-lg-5 col-sm-4"> MPAY</label>
                <label class="col-lg-3 col-sm-3">{{ (cc.mpaycost || 0 ) | currencyFormat  }} </label>
                <label class="col-lg-3 col-sm-3">{{ (cc.mpayvolume || 0) }} Texts</label>
            </div>
            <label class="col-lg-5 col-sm-4">Within Company</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.withincompanycost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.withincompanyduration || 0) | number:'1.2-2' }} Mins</label>

            <label class="col-lg-5 col-sm-4">Uncategorised</label>
            <label class="col-lg-3 col-sm-3">{{ (cc.uncategorisedcost || 0 ) | currencyFormat  }} </label>
            <label class="col-lg-3 col-sm-3">{{ (cc.uncategorisedduration || 0) | number:'1.2-2' }} Mins</label>
        </div>
    </div>
</div>

<div class="row col-lg-12 vert-offset-top-1 lbl-bold" *ngIf="callclassreportviewmodel as cc"
    [hidden]="reportheader && !mobilenumber">
    <div class=" col-lg-12 text-left">
        <h4>Invoice Break Down:</h4>
    </div>
    <div class="col-lg-6 col-sm-12">
        <label class="col-lg-5 col-sm-4">Recurring Charge</label>
        <label class="col-lg-3 col-sm-3">{{ (cc.monthlinerental || 0) | currencyFormat}} </label>
        <label class="col-lg-5 col-sm-4">Other Charge</label>
        <label class="col-lg-3 col-sm-3">{{ (cc.othercharges || 0) | currencyFormat}} </label>
        <label class="col-lg-5 col-sm-4">Total Usage Cost</label>
        <label class="col-lg-3 col-sm-3">{{ (cc.totalusagecost || 0) | currencyFormat}} </label>

    </div>
    <div class="col-lg-6 col-sm-12 float-right">
        <label class="col-lg-5 col-sm-4">Recurring Credit</label>
        <label class="col-lg-3 col-sm-3">{{ (cc.linerentalcredit || 0) | currencyFormat}} </label>
        <label class="col-lg-5 col-sm-4">Other Credit</label>
        <label class="col-lg-3 col-sm-3">{{ (cc.othercredits || 0) | currencyFormat}} </label>
        <label class="col-lg-5 col-sm-4">Total</label>
        <label class="col-lg-3 col-sm-3">{{ (cc.total || 0) | currencyFormat}} </label>
    </div>
</div>

<p-dataTable #dt [value]="callclassitemisedviewmodel?.callclassitemised" [rows]="10" [paginator]="true"
    [responsive]="true" scrollable="true" [frozenWidth]="mobilenumber? '0px':'150px'" unfrozenWidth="100%"
    [style]="{'margin-top':'30px'}" [rowsPerPageOptions]="[5,10,20]"
    exportFilename="total-billing-information-itemisation">
    <p-header>
        <div class="ui-helper-clearfix">
            <button type="button" pButton icon="fa fa-file-o" iconPos="left" label="Export To CSV"
                (click)="dt.exportCSV(true)" style="float:left"></button>
        </div>
    </p-header>
    <p-column field="mobilenumber" [style]="{'width':'150px'}" frozen="true" *ngIf="!mobilenumber"
        header="Mobile Number" filter="true" filterMatchMode="contains" [sortable]="true"></p-column>


    <p-column [style]="{'width':'150px'}" *ngFor="let column of datacolumns" rowspan="3" [header]="column.header"
        [hidden]="column.hidden" [filter]="column.filter" [field]="column.field" [filterMatchMode]="column.filtermode"
        [sortable]="column.sortable">
    </p-column>



    <p-column [style]="{'width':'150px'}" field="calldate" header="Date" filter="true" filterMatchMode="contains"
        sortable="true"></p-column>
    <p-column [style]="{'width':'150px'}" field="calltime" header="Time" filter="true" filterMatchMode="contains"
        sortable="true"></p-column>
    <p-column field="username" [style]="{'width':'220px'}" *ngIf="!mobilenumber" header="Employee Name" filter="true"
        filterMatchMode="contains" [sortable]="true"></p-column>
    <p-column field="calltype" [style]="{'width':'150px'}" header="Category" filter="true" filterMatchMode="contains"
        [sortable]="true"></p-column>
    <p-column field="description" [style]="{'width':'180px'}" header="Call Class" filter="true"
        filterMatchMode="contains" [sortable]="true"></p-column>
    <p-column field="destination" [style]="{'width':'180px'}" header="Destination" filter="true"
        filterMatchMode="contains" [sortable]="true"></p-column>
    <p-column field="notes" [style]="{'width':'200px'}" header="Area Category" filter="true" filterMatchMode="contains"
        [sortable]="true"></p-column>
    <p-column field="numberdialledapn" [style]="{'width':'180px'}" header="Number Dialled" [sortable]="true"
        filter="true" filterMatchMode="contains"></p-column>
    <p-column styleClass="text-right" [style]="{'width':'100px'}" field="duration" header="Duration" [sortable]="true"
        displaysum="true"></p-column>
    <p-column styleClass="text-right" [style]="{'width':'100px'}" field="minutes" header="Duration (Mins)"
        [hidden]="true" [sortable]="true" displaysum="true">
        <ng-template let-col let-cc="rowData" pTemplate="body">
            <span>{{cc[col.field] | number:'1.2-2' }}</span>
        </ng-template>
    </p-column>
    <p-column styleClass="text-right" [style]="{'width':'150px'}" field="datavolume" header="Data(MB)" [sortable]="true"
        displaysum="true">
        <ng-template let-col let-cc="rowData" pTemplate="body">
            <span>{{cc[col.field] | number:'1.2-2' }}</span>
        </ng-template>
    </p-column>
    <p-column field="countryoforigin" [style]="{'width':'150px'}" header="Country Of Origin" filter="true"
        filterMatchMode="contains" [sortable]="true"></p-column>
    <p-column field="eurozone" [style]="{'width':'150px'}" header="Zone"
        *ngIf="callclassitemisedviewmodel?.eurozonedetails?.length" filter="true" filterMatchMode="equals"
        [sortable]="true">
        <ng-template pTemplate="filter" let-col>
            <i class="fa fa-close" *ngIf="zonefilter!=null"
                (click)="zonefilter=null;dt.filter(null,col.field,col.filterMatchMode)"></i>
            <p-dropdown appendTo="body" [options]="zonefilterset" [style]="{'width':'100%'}" [(ngModel)]="zonefilter"
                (onChange)="dt.filter($event.value,col.field,col.filterMatchMode)"></p-dropdown>
        </ng-template>
    </p-column>
    <p-column styleClass="text-right" [style]="{'width':'150px'}" field="usagecharge" header="UsageCharge"
        [sortable]="true" displaysum="true">
        <ng-template let-col let-cc="rowData" pTemplate="body">
            <span>{{cc[col.field] | currencyFormat }}</span>
        </ng-template>
    </p-column>
</p-dataTable>


<div class="vert-offset-top-2" style="text-align:center;">
    There may be a slight discrepancy between the reports and the invoice, due to the
    rounding rules used to display the report information.<br />
    The amount you are charged is as shown on your invoice.
</div>